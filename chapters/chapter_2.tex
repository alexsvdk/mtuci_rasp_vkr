\newpage
\begin{center}
    \textbf{\large 2. СЕРВИС ПАРСИНГА РАСПИСАНИЯ}
\end{center}
\refstepcounter{chapter}
\addcontentsline{toc}{chapter}{2. СЕРВИС ПАРСИНГА РАСПИСАНИЯ}

Микросервис парсига расписания предназначен для извлечения данных расписания из exel 
файла в формате \texttt{*.xlsx} и сохранения их в базу данных.

\section{Обзор технологий, использованных при разработке сервиса парсинга расписания}

\textbf{Apache POI} - это библиотека, которая позволяет работать с файлами Microsoft Office, 
такими как документы Word, книги Excel и презентации PowerPoint, используя язык программирования Java.

\textbf{Jsoup} - это Java-библиотека для простого и удобного извлечения и манипулирования данными HTML-документов. 
Она позволяет анализировать HTML-код и извлекать информацию из веб-страниц, 
а также создавать и изменять HTML-документы.

\textbf{IMAP (Internet Message Access Protocol)} - это протокол прикладного уровня, 
который используется для получения электронной почты с почтового сервера. 
Он позволяет пользователям получать доступ к своим электронным письмам, 
папкам и другим объектам на почтовом сервере из любого места в Интернете. 
В отличие от протокола POP3, который загружает сообщения на устройство пользователя и удаляет их 
с сервера, IMAP позволяет пользователям просматривать сообщения на сервере 
и синхронизировать изменения между несколькими устройствами.

\textbf{Парсинг} - это процесс автоматического сбора и анализа информации из различных источников данных, 
таких как веб-страницы, документы или электронная почта. 
Этот процесс позволяет получать большие объемы данных и использовать их для различных целей, 
таких как анализ, обработка или хранение. 
В контексте этого документа, парсинг используется для извлечения информации о 
расписании занятий из электронных таблиц в формате Excel.

\section{Процесс парсинга расписания}
\begin{enumerate}
\item Каждые 10 минут, сервис сканирует содержимое IMAP почтового ящика.
\item Если поступает письмо со вложениями - начинается процесс их загрузки и дальнейшего Парсинга.
\item Если поступил архив - сервис распаковывает архив и начинает обработку файлов внутри него.
\item Если поступил файл Excel - сервис сразу приступает к анализу файла.
\item Для анализа Excel таблиц используется библиотека Apache POI.
\item После анализа сервис сохраняет полученную информацию в базу данных, откуда ее будет использовать сервис GraphQL API.
\item После сохранения сервис ищет недостающие данные о новых преподавателях на сайте 
[mtuci.ru](http://mtuci.ru). После этой операции в базу записываются такие данные как полное ФИО, 
электронная почта, и фотография.
\item По окончанию работы сервис отправляет уведомление на почту с логом работы.
\end{enumerate}

\section{Результат разработки сервиса парсинга расписания}
На данный момент сервис активен, и принимает данные на почтом ящик a.s.shvedchikov@mtuci.ru. 
Исходный код сервиса расположен на доступен по ссылке \url{https://github.com/alexsvdk/mtuci_rasp_back/tree/master/parser}.